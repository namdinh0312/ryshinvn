/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/drift-zoom@1.4.0/lib/Trigger.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _throwIfMissing=_interopRequireDefault(require("./util/throwIfMissing")),_BoundingBox=_interopRequireDefault(require("./BoundingBox"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var Trigger=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this._show=this._show.bind(this),this._hide=this._hide.bind(this),this._handleEntry=this._handleEntry.bind(this),this._handleMovement=this._handleMovement.bind(this);var i=t.el,n=void 0===i?(0,_throwIfMissing.default)():i,s=t.zoomPane,o=void 0===s?(0,_throwIfMissing.default)():s,h=t.sourceAttribute,l=void 0===h?(0,_throwIfMissing.default)():h,r=t.handleTouch,u=void 0===r?(0,_throwIfMissing.default)():r,a=t.onShow,d=void 0===a?null:a,v=t.onHide,c=void 0===v?null:v,g=t.hoverDelay,_=void 0===g?0:g,f=t.touchDelay,m=void 0===f?0:f,y=t.hoverBoundingBox,p=void 0===y?(0,_throwIfMissing.default)():y,w=t.touchBoundingBox,B=void 0===w?(0,_throwIfMissing.default)():w,E=t.namespace,b=void 0===E?null:E,M=t.zoomFactor,D=void 0===M?(0,_throwIfMissing.default)():M,x=t.boundingBoxContainer,T=void 0===x?(0,_throwIfMissing.default)():x;this.settings={el:n,zoomPane:o,sourceAttribute:l,handleTouch:u,onShow:d,onHide:c,hoverDelay:_,touchDelay:m,hoverBoundingBox:p,touchBoundingBox:B,namespace:b,zoomFactor:D,boundingBoxContainer:T},(this.settings.hoverBoundingBox||this.settings.touchBoundingBox)&&(this.boundingBox=new _BoundingBox.default({namespace:this.settings.namespace,zoomFactor:this.settings.zoomFactor,containerEl:this.settings.boundingBoxContainer})),this.enabled=!0,this._bindEvents()}return _createClass(e,[{key:"_preventDefault",value:function(e){e.preventDefault()}},{key:"_preventDefaultAllowTouchScroll",value:function(e){this.settings.touchDelay&&this._isTouchEvent(e)&&!this.isShowing||e.preventDefault()}},{key:"_isTouchEvent",value:function(e){return!!e.touches}},{key:"_bindEvents",value:function(){this.settings.el.addEventListener("mouseenter",this._handleEntry,!1),this.settings.el.addEventListener("mouseleave",this._hide,!1),this.settings.el.addEventListener("mousemove",this._handleMovement,!1),this.settings.handleTouch?(this.settings.el.addEventListener("touchstart",this._handleEntry,!1),this.settings.el.addEventListener("touchend",this._hide,!1),this.settings.el.addEventListener("touchmove",this._handleMovement,!1)):(this.settings.el.addEventListener("touchstart",this._preventDefault,!1),this.settings.el.addEventListener("touchend",this._preventDefault,!1),this.settings.el.addEventListener("touchmove",this._preventDefault,!1))}},{key:"_unbindEvents",value:function(){this.settings.el.removeEventListener("mouseenter",this._handleEntry,!1),this.settings.el.removeEventListener("mouseleave",this._hide,!1),this.settings.el.removeEventListener("mousemove",this._handleMovement,!1),this.settings.handleTouch?(this.settings.el.removeEventListener("touchstart",this._handleEntry,!1),this.settings.el.removeEventListener("touchend",this._hide,!1),this.settings.el.removeEventListener("touchmove",this._handleMovement,!1)):(this.settings.el.removeEventListener("touchstart",this._preventDefault,!1),this.settings.el.removeEventListener("touchend",this._preventDefault,!1),this.settings.el.removeEventListener("touchmove",this._preventDefault,!1))}},{key:"_handleEntry",value:function(e){this._preventDefaultAllowTouchScroll(e),this._lastMovement=e,"mouseenter"==e.type&&this.settings.hoverDelay?this.entryTimeout=setTimeout(this._show,this.settings.hoverDelay):this.settings.touchDelay?this.entryTimeout=setTimeout(this._show,this.settings.touchDelay):this._show()}},{key:"_show",value:function(){if(this.enabled){var e=this.settings.onShow;if(e&&"function"==typeof e&&e(),this.settings.zoomPane.show(this.settings.el.getAttribute(this.settings.sourceAttribute),this.settings.el.clientWidth,this.settings.el.clientHeight),this._lastMovement){var t=this._lastMovement.touches;(t&&this.settings.touchBoundingBox||!t&&this.settings.hoverBoundingBox)&&this.boundingBox.show(this.settings.zoomPane.el.clientWidth,this.settings.zoomPane.el.clientHeight)}this._handleMovement()}}},{key:"_hide",value:function(e){e&&this._preventDefaultAllowTouchScroll(e),this._lastMovement=null,this.entryTimeout&&clearTimeout(this.entryTimeout),this.boundingBox&&this.boundingBox.hide();var t=this.settings.onHide;t&&"function"==typeof t&&t(),this.settings.zoomPane.hide()}},{key:"_handleMovement",value:function(e){if(e)this._preventDefaultAllowTouchScroll(e),this._lastMovement=e;else{if(!this._lastMovement)return;e=this._lastMovement}var t,i;if(e.touches){var n=e.touches[0];t=n.clientX,i=n.clientY}else t=e.clientX,i=e.clientY;var s=this.settings.el.getBoundingClientRect(),o=t-s.left,h=i-s.top,l=o/this.settings.el.clientWidth,r=h/this.settings.el.clientHeight;this.boundingBox&&this.boundingBox.setPosition(l,r,s),this.settings.zoomPane.setPosition(l,r,s)}},{key:"isShowing",get:function(){return this.settings.zoomPane.isShowing}}]),e}();exports.default=Trigger;
//# sourceMappingURL=/sm/dd51959dde01d9c3fb57b0b5a8868be107cb0ef75b113155f2a7d9a674931f2d.map