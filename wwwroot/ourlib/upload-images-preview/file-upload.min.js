"use strict";function FileUpload(){this.InputElement=null,this.PreviewBoxElement=null,this.CurentImageBox=null,this.Form=null,this.MaxFile=null,this.StoredFiles=[],this.CurentFiles=[],this.CurentPreviewImages=[],this.Extend=function(e,t,i,n,a,r,s,l,o,u,h){this.InputElement=n,this.PreviewBoxElement=r,this.CurentImageBox=a,this.Form=s,this.UniqueControlName=h||"CurentFilePaths[]",this.MaxFile=l||2,this.InputChangeCallBack=void 0!==o?o:null,this.InputElement.addEventListener("change",this.InputChange),(this.InputElement.fileUpload=this).FileReader=new FileReader,this.IsCreateInputName=u||!1,this.HostCdn=e||"",this.CurentFiles=t||[],this.CurentPreviewImages=i||[],this.Process()},this.Process=function(){if(this.CurentImageBox)for(var t=this,e=0;e<this.CurentFiles.length;e++){var i=this.CurentFiles[e],n=this.CurentPreviewImages[e],a=document.createElement("div");a.className="col-3 gutter-10 _p-item";var r=document.createElement("figure");r.className="_max-height-200 relative hover-children-show";var s=document.createElement("button");s.className="absolute hide tablet-show -border width-100 height-100 _fill-silver-opacity text-strong",s.innerText="CLICK ĐỂ XÓA",s.type="button",s.dataset.file=i,s.dataset.notClose="I",s.addEventListener("click",function(e){t.RemoveCurentFile(e,t.InputElement)});var l=i.substring(i.lastIndexOf("/")+1),o="<img class='_max-width-100-percent'   onerror='this.src=\"/images/shared/no-image.svg\"'   src='"+t.HostCdn+n+"' alt='"+l+"' data-file='"+l+"' /><figcaption class='padding-5 text-center _text-ellipsis'>"+l+"</figcaption>";if(t.IsCreateInputName)o+="<input type='text' class='_hidden'   onerror='this.src=\"/images/shared/no-image.svg\"'   name='"+t.UniqueControlName+"' value="+i+(t.Form?" form='"+t.Form.id+"'":"")+"></input>";r.innerHTML=o,r.insertBefore(s,r.childNodes[0]),a.appendChild(r),t.CurentImageBox.appendChild(a)}},this.InputChange=function(e){var s=e.target.fileUpload,t=e.target.files,i=Array.prototype.slice.call(t);s.PreviewBoxElement.innerHTML="",s.StoredFiles=[],i.forEach(function(r){if(r.type.match("image.*")&&(s.StoredFiles.push(r),s.PreviewBoxElement===s.CurentImageBox&&(s.CurentFiles=[],s.CurentImageBox.innerHTML=""),s.StoredFiles.length+s.CurentFiles.length<=s.MaxFile)){var e=new FileReader;e.onload=function(e){var t=document.createElement("div");t.className="gutter-10 _p-item";var i=document.createElement("figure");i.className="_max-height-200 relative hover-children-show";var n=document.createElement("button");n.className="absolute hide -border width-100 height-100 _fill-silver-opacity text-strong",n.type="button",n.innerText="CLICK ĐỂ XÓA",n.dataset.file=r.name,n.dataset.notClose="I",n.addEventListener("click",function(e){s.RemoveFile(e,s.InputElement)});var a="<img class='width-100 _max-width-100-percent' src='"+e.target.result+"' alt='"+r.name+"' data-file='"+r.name+"' /><figcaption class='padding-5 text-center _text-ellipsis'>("+r.size%1e3+" kb) "+r.name+"</figcaption>";s.IsCreateInputName&&(a+="<input type='text' class='_hidden' name='NewFiles"+s.UniqueControlName+"[]' value="+r.name+(s.Form?" form='"+s.Form.id+"'":"")+"></input>");i.innerHTML=a,i.insertBefore(n,i.childNodes[0]),t.appendChild(i),s.PreviewBoxElement.appendChild(t)},e.readAsDataURL(r)}}),s.InputChangeCallBack&&s.InputChangeCallBack(s.StoredFiles)},this.RemoveCurentFile=function(e){for(var t=e.target.dataset.file,i=0;i<this.CurentFiles.length;i++)if(this.CurentFiles[i]===t){this.CurentFiles.splice(i,1);break}Site.FindParent(e.target,"_p-item").remove()},this.RemoveFile=function(e,t){for(var i=e.target.dataset.file,n=0;n<this.StoredFiles.length;n++)if(this.StoredFiles[n].name===i){this.StoredFiles.splice(n,1);break}Site.FindParent(e.target,"_p-item").remove(),Site.ClearInputFile(t)},this.Init=function(e,t,i,n,a,r,s,l,o,u,h){var m=document.querySelector(n),d=document.querySelector(r),c=document.querySelector(a),p=document.querySelector(s);null!=m&&null!=d||console.warn(n+" or "+d+": NULL"),this.Extend(e,t,i,m,c,d,p,l,o,u,h)}}